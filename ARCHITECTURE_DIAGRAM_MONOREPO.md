# Arquitectura del Monorepo - Diagrama Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BOT-TWITCH MONOREPO                          â”‚
â”‚                     (Scope Rule + Screaming Arch)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ packages/shared - Single Source of Truth                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  src/                                                                â”‚
â”‚  â”œâ”€â”€ task/                                                           â”‚
â”‚  â”‚   â”œâ”€â”€ models.ts          â†’ Task, UserTasks                       â”‚
â”‚  â”‚   â””â”€â”€ index.ts                                                    â”‚
â”‚  â””â”€â”€ spotify/                                                        â”‚
â”‚      â”œâ”€â”€ models.ts          â†’ SpotifyTrack, SpotifyPlayerState      â”‚
â”‚      â””â”€â”€ index.ts                                                    â”‚
â”‚                                                                      â”‚
â”‚  ğŸ“¤ Exports: @bot-twitch/shared/task                                 â”‚
â”‚             @bot-twitch/shared/spotify                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–²
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                               â”‚
                    â”‚                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– packages/bot-backend        â”‚  â”‚  ğŸ¨ packages/obs-overlay    â”‚
â”‚     (Node.js + Twitch)          â”‚  â”‚     (React + OBS)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  src/                           â”‚  â”‚  src/                       â”‚
â”‚  â”œâ”€â”€ features/                  â”‚  â”‚  â”œâ”€â”€ features/              â”‚
â”‚  â”‚   â”œâ”€â”€ task-management/       â”‚  â”‚  â”‚   â”œâ”€â”€ stream-task-      â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ models.ts (local)  â”‚  â”‚  â”‚   â”‚   display/          â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ service.ts         â”‚  â”‚  â”‚   â”‚   â”œâ”€â”€ stream-task-  â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ utils.ts           â”‚  â”‚  â”‚   â”‚   â”‚   display.tsx   â”‚
â”‚  â”‚   â”‚   â””â”€â”€ commands/          â”‚  â”‚  â”‚   â”‚   â”‚   (Container!)  â”‚
â”‚  â”‚   â”‚       â””â”€â”€ *.command.ts   â”‚  â”‚  â”‚   â”‚   â”œâ”€â”€ components/   â”‚
â”‚  â”‚   â”‚                          â”‚  â”‚  â”‚   â”‚   â”‚   â”œâ”€â”€ Compact   â”‚
â”‚  â”‚   â””â”€â”€ spotify-integration/   â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   TaskList  â”‚
â”‚  â”‚       â”œâ”€â”€ models.ts (local)  â”‚  â”‚  â”‚   â”‚   â”‚   â””â”€â”€ Animated  â”‚
â”‚  â”‚       â”œâ”€â”€ service.ts         â”‚  â”‚  â”‚   â”‚   â”‚       TaskItem  â”‚
â”‚  â”‚       â””â”€â”€ routes.ts          â”‚  â”‚  â”‚   â”‚   â””â”€â”€ hooks/        â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚   â”‚       â””â”€â”€ use-task-  â”‚
â”‚  â”œâ”€â”€ infrastructure/            â”‚  â”‚  â”‚   â”‚           connection â”‚
â”‚  â”‚   â”œâ”€â”€ config/                â”‚  â”‚  â”‚   â”‚                     â”‚
â”‚  â”‚   â”œâ”€â”€ logging/               â”‚  â”‚  â”‚   â””â”€â”€ now-playing-      â”‚
â”‚  â”‚   â””â”€â”€ rate-limiting/         â”‚  â”‚  â”‚       display/          â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚       â”œâ”€â”€ now-playing-  â”‚
â”‚  â””â”€â”€ shared/                    â”‚  â”‚  â”‚       â”‚   display.tsx   â”‚
â”‚      â””â”€â”€ bot-commands/          â”‚  â”‚  â”‚       â”‚   (Container!)  â”‚
â”‚          â”œâ”€â”€ hello.command.ts   â”‚  â”‚  â”‚       â”œâ”€â”€ components/   â”‚
â”‚          â””â”€â”€ help.command.ts    â”‚  â”‚  â”‚       â”‚   â”œâ”€â”€ Spotify   â”‚
â”‚                                 â”‚  â”‚  â”‚       â”‚   â”‚   Widget    â”‚
â”‚  ğŸ“¥ Imports:                     â”‚  â”‚  â”‚       â”‚   â””â”€â”€ Spotify   â”‚
â”‚     @bot-twitch/shared/task     â”‚  â”‚  â”‚       â”‚       Icon      â”‚
â”‚     @bot-twitch/shared/spotify  â”‚  â”‚  â”‚       â””â”€â”€ hooks/        â”‚
â”‚                                 â”‚  â”‚  â”‚           â””â”€â”€ use-       â”‚
â”‚  ğŸš€ Entry: app.ts               â”‚  â”‚  â”‚               spotify-   â”‚
â”‚  ğŸ§ª Tests: jest                 â”‚  â”‚  â”‚               player     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                         â”‚
                                    â”‚  â”œâ”€â”€ shared/                â”‚
                                    â”‚  â”‚   â””â”€â”€ styles/            â”‚
                                    â”‚  â”‚       â””â”€â”€ global-styles  â”‚
                                    â”‚  â”‚                          â”‚
                                    â”‚  â””â”€â”€ App.tsx                â”‚
                                    â”‚      (Orquestador)          â”‚
                                    â”‚                             â”‚
                                    â”‚  ğŸ“¥ Imports:                 â”‚
                                    â”‚     @bot-twitch/shared/task â”‚
                                    â”‚     @bot-twitch/shared/     â”‚
                                    â”‚         spotify             â”‚
                                    â”‚     @features/*             â”‚
                                    â”‚     @shared/*               â”‚
                                    â”‚                             â”‚
                                    â”‚  ğŸš€ Entry: main.tsx         â”‚
                                    â”‚  âš¡ Build: Vite             â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¯ SCOPE RULE APLICADO                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  âœ… Componentes en features/ â†’ SOLO usados por ESA feature          â”‚
â”‚  âœ… Tipos en @bot-twitch/shared â†’ Usados por 2+ packages            â”‚
â”‚  âœ… Estilos en shared/ â†’ Usados por 2+ features                     â”‚
â”‚  âœ… Infrastructure/ â†’ Cross-cutting concerns                         â”‚
â”‚                                                                      â”‚
â”‚  âŒ NO HAY componentes/utils genÃ©ricos sin dueÃ±o claro              â”‚
â”‚  âŒ NO HAY duplicaciÃ³n de tipos entre backend y frontend            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¡ FLUJO DE DATOS                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Twitch Chat  â”€â”€â”¬â”€â†’  bot-backend                                    â”‚
â”‚                 â”‚    â””â”€â†’ task-management                            â”‚
â”‚                 â”‚        â””â”€â†’ WebSocket emit                         â”‚
â”‚                 â”‚                â–¼                                  â”‚
â”‚                 â””â”€â†’  obs-overlay                                    â”‚
â”‚                      â””â”€â†’ stream-task-display                        â”‚
â”‚                          â””â”€â†’ useTaskConnection (WebSocket)          â”‚
â”‚                                                                      â”‚
â”‚  Spotify API  â”€â”€â”€â†’  bot-backend                                     â”‚
â”‚                     â””â”€â†’ spotify-integration                         â”‚
â”‚                         â””â”€â†’ REST endpoint /api/spotify/player       â”‚
â”‚                                    â–¼                                â”‚
â”‚                     obs-overlay                                     â”‚
â”‚                     â””â”€â†’ now-playing-display                         â”‚
â”‚                         â””â”€â†’ useSpotifyPlayer (polling)              â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ› ï¸ COMANDOS DE DESARROLLO                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  pnpm install         â†’ Instala todo el monorepo                    â”‚
â”‚  pnpm build           â†’ Build todos los packages                    â”‚
â”‚  pnpm dev             â†’ Solo backend                                â”‚
â”‚  pnpm dev:overlay     â†’ Solo overlay                                â”‚
â”‚  pnpm dev:full        â†’ Backend + Overlay (concurrently)            â”‚
â”‚  pnpm test            â†’ Tests del backend                           â”‚
â”‚  pnpm lint            â†’ Lint todos los packages                     â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ›ï¸ Decisiones ArquitectÃ³nicas Clave

### 1. Monorepo con pnpm workspaces
**RazÃ³n**: Tipos compartidos sin necesidad de publicar a npm, refactorings atÃ³micos.

### 2. packages/shared separado
**RazÃ³n**: Single Source of Truth para tipos, evita duplicaciÃ³n entre backend/frontend.

### 3. Features con containers del mismo nombre
**RazÃ³n**: Screaming Architecture - `stream-task-display.tsx` en `stream-task-display/` grita su propÃ³sito.

### 4. Scope Rule estricto
**RazÃ³n**: Previene over-engineering y mantiene ownership claro.

### 5. Alias de imports (@features, @shared, @infrastructure)
**RazÃ³n**: Imports limpios, fÃ¡cil refactoring, evita ../../../

## ğŸ“Š ComparaciÃ³n: Antes vs DespuÃ©s

### ANTES âŒ
```
src/components/             â†’ Â¿QuiÃ©n usa quÃ©?
obs-overlay/src/types/      â†’ Tipos duplicados
```

### DESPUÃ‰S âœ…
```
packages/shared/            â†’ Single Source of Truth
features/stream-task-display/components/  â†’ Ownership claro
```
